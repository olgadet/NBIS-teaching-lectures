setwd("~/Documents/NBIS/Teaching/!Teaching/201710_scRNA/Lecture")
setwd("~/Documents/NBIS/!PROJECTS/Resolved/2886_pericytes/!Documentation")
setwd("~/Documents/NBIS/!PROJECTS/Resolved/2886_pericytes/!Documentation")
rm(list=ls())
library(edgeR)
library(ggplot2)
library(gplots)
library(biomaRt)
library(xtable)
library(RColorBrewer)
library(grid)
library(gridExtra)
source("/Users/olga/Documents/BILS/Scripts/R/multiplot.R")
rm(list=ls())
library(edgeR)
library(ggplot2)
library(gplots)
library(biomaRt)
library(xtable)
library(RColorBrewer)
library(grid)
library(gridExtra)
source("/Users/olga/Documents/NBIS/Scripts/R/multiplot.R")
dir.data <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results"
file.counts <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts.txt"
file.annotations <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts_annotations.txt"
file.experiment <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/Sample-Names_single-cell_RNA_Seq-SONIYA.txt"
# Reading in data
# counts
data.counts <- as.matrix(read.delim(file.counts))
colnames(data.counts) <- gsub("\\.", "-", sub('_L00.*', "", colnames(data.counts)))
idx.dup <- which(duplicated(colnames(data.counts))==TRUE)
idx.match <- idx.dup-1
data.counts <- data.frame(data.counts[, -c(idx.dup)])
colnames(data.counts) <- gsub("\\.", "-", sub('_L00.*', "", colnames(data.counts)))
rm(idx.dup, idx.match)
# annotations
data.annotations <- as.matrix(read.delim(file.annotations))
data.experiment <- read.delim(file.experiment)
# groupings
exp.samples <- paste(data.experiment[,1], '_', data.experiment[,3], sep="")
exp.groups <- rep("No cell", nrow(data.experiment))
exp.groups[grep("Tumor", data.experiment[,2])]="Tumor"
exp.groups[grep("Brain", data.experiment[,2])]="Brain"
idx <- match(colnames(data.counts), exp.samples)
data.group <- rep("X", ncol(data.counts))
data.group <- exp.groups[idx]
rm(idx, exp.groups, exp.samples, data.experiment)
# edgeR dataset
data.cds <- DGEList(data.counts)
rm(list=ls())
library(edgeR)
library(ggplot2)
library(gplots)
library(biomaRt)
library(xtable)
library(RColorBrewer)
library(grid)
library(gridExtra)
source("/Users/olga/Documents/NBIS/Scripts/R/multiplot.R")
dir.data <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results"
file.counts <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts.txt"
file.annotations <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts_annotations.txt"
file.experiment <- "/Users/olga/Documents/BILS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/Sample-Names_single-cell_RNA_Seq-SONIYA.txt"
data.counts <- as.matrix(read.delim(file.counts))
dir.data <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results"
file.counts <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts.txt"
file.annotations <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts_annotations.txt"
file.experiment <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/Sample-Names_single-cell_RNA_Seq-SONIYA.txt"
data.counts <- as.matrix(read.delim(file.counts))
dir.data <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results"
file.counts <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts.txt"
file.annotations <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/tableCounts_annotations.txt"
file.experiment <- "/Users/olga/Documents/NBIS/!PROJECTS/2886_pericytes/!Documentation/Results/SCS/Sample-Names_single-cell_RNA_Seq-SONIYA.txt"
data.counts <- as.matrix(read.delim(file.counts))
dir.data <- "/Users/olga/Documents/NBIS/!PROJECTS/Resolved/2886_pericytes/!Documentation/Results"
file.counts <- "/Users/olga/Documents/NBIS/!PROJECTS/Resolved/2886_pericytes/!Documentation/Results/SCS/tableCounts.txt"
file.annotations <- "/Users/olga/Documents/NBIS/!PROJECTS/Resolved/2886_pericytes/!Documentation/Results/SCS/tableCounts_annotations.txt"
file.experiment <- "/Users/olga/Documents/NBIS/!PROJECTS/Resolved/2886_pericytes/!Documentation/Results/SCS/Sample-Names_single-cell_RNA_Seq-SONIYA.txt"
data.counts <- as.matrix(read.delim(file.counts))
colnames(data.counts) <- gsub("\\.", "-", sub('_L00.*', "", colnames(data.counts)))
idx.dup <- which(duplicated(colnames(data.counts))==TRUE)
idx.match <- idx.dup-1
data.counts <- data.frame(data.counts[, -c(idx.dup)])
colnames(data.counts) <- gsub("\\.", "-", sub('_L00.*', "", colnames(data.counts)))
rm(idx.dup, idx.match)
data.annotations <- as.matrix(read.delim(file.annotations))
data.experiment <- read.delim(file.experiment)
exp.samples <- paste(data.experiment[,1], '_', data.experiment[,3], sep="")
exp.groups <- rep("No cell", nrow(data.experiment))
exp.groups[grep("Tumor", data.experiment[,2])]="Tumor"
exp.groups[grep("Brain", data.experiment[,2])]="Brain"
idx <- match(colnames(data.counts), exp.samples)
data.group <- rep("X", ncol(data.counts))
data.group <- exp.groups[idx]
rm(idx, exp.groups, exp.samples, data.experiment)
head(data.counts)
exp.groups
exp.samples <- paste(data.experiment[,1], '_', data.experiment[,3], sep="")
data.annotations <- as.matrix(read.delim(file.annotations))
data.experiment <- read.delim(file.experiment)
exp.samples <- paste(data.experiment[,1], '_', data.experiment[,3], sep="")
exp.groups <- rep("No cell", nrow(data.experiment))
exp.groups[grep("Tumor", data.experiment[,2])]="Tumor"
exp.groups[grep("Brain", data.experiment[,2])]="Brain"
idx <- match(colnames(data.counts), exp.samples)
data.group <- rep("X", ncol(data.counts))
data.group <- exp.groups[idx]
rm(idx, exp.groups, exp.samples, data.experiment)
exp.gr
exp.groups
data.group
length(data.group)
dim(data.group)
dim(data.counts)
hist(data.counts[,data.group=="Tumor"])
hist(data.counts[1,data.group=="Tumor"])
?save
save(data.counts, data.group, file="testData.RData")
setwd("~/Documents/NBIS/Teaching/!Teaching/201710_scRNA/Scripts")
dir()
load("testData.RData")
rm(list=ls())
load("testData.RData")
idx.tumor <- which(data.group=="Tumor")
idx.tumor
hist(data.counts[, idx.tumor])
class(data.counts)
data.counts <- as.matrix(data.counts)
hist(data.counts[, idx.tumor])
hist(data.counts[, idx.tumor], n=100)
unique(data.group)
idx.normal <- which(data.group=="Brain")
hist(data.counts[1, idx.tumor], n=100)
hist(data.counts[1, idx.tumor])
data.counts[1,]
hist(data.counts[2, idx.tumor])
sum.0 <- apply(data.counts, 1, sum)
length(sum.0)
dim(data.counts)
idx.0 <- which(apply(data.counts, 1, sum)==0)
length(idx.0)
data.subset <- data.counts[-idx.0, ]
hist(data.subset[2, idx.tumor])
hist(data.subset[2, idx.tumor], n=100)
hist(data.subset[1:10, idx.tumor], n=100)
hist(data.subset[, idx.tumor], n=100)
hist(data.subset[, idx.brain], n=100)
idx.normal <- which(data.group=="Brain")
hist(data.subset[, idx.normal], n=100)
hist(data.subset[1, idx.tumor], n=100)
hist(data.subset[1, idx.normal], n=100)
hist(data.subset[1, idx.tumor], n=100)
hist(data.subset[1:10, idx.tumor], n=100)
hist(data.subset[1:10, idx.normal], n=100)
setwd("~/Documents/NBIS/!PROJECTS/Resolved/3230_ags/!Documentation")
rm(list=ls())
library(edgeR)
library(scater)
#library(simpleSingleCell)
library(scran)
library(org.Mm.eg.db)
library(RBGL)
library(gplots)
library(xtable)
fontsize <- theme(axis.text=element_text(size=12), axis.title=element_text(size=16))
#detach("package:simpleSingleCell", unload=TRUE)
#detach("package:scran", unload=TRUE)
file.counts="/Users/olga/Documents/NBIS/!PROJECTS/Resolved/3230_ags/DATA/SS2_16_190_expression/counts.tab"
file.ercc="/Users/olga/Documents/NBIS/!PROJECTS/Resolved/3230_ags/DATA/SS2_16_190_expression/counts-ercc.tab"
file.markers="/Users/olga/Documents/NBIS/!PROJECTS/Resolved/3230_ags/DATA/Markers_ECsVSMCs_20160930.txt"
data.markers <- read.delim(file.markers)
data.counts <- read.delim(file.counts)
hist(data.counts[,1])
hist(as.matrix(data.counts[,1]))
hist(as.matrix(data.counts[1,]))
class(data.counts)
data.ercc <- read.delim(file.ercc)
data.all <- rbind(data.counts, data.ercc)
data.all <- data.all[!duplicated(data.all[,1]),]
rownames(data.all) <- data.all[,1]
data.all <- data.all[,-1]
head(data.all)
class(data.all)
data.test <- as.matrix(data.all)
hist(data.test[1,])
hist(data.test[1,], n=100)
hist(data.test[1:100,], n=100)
hist(data.test[,], n=100)
dir()
setwd("~/Documents/NBIS/Teaching/!Teaching/201710_scRNA/Scripts")
dir()
load("../DE/mast_data.Rdata")
setwd("~/Documents/NBIS/Teaching/!Teaching/201710_scRNA/Lecture")
?randomNodeGraph
?runif
x1 <- dnorm(100, mean = 0, sd = 1, log = FALSE)
x1
x1 <- rnorm(100, mean = 0, sd = 1, log = FALSE)
x1 <- rnorm(100, mean = 0, sd = 1)
x1
hist(x1)
plot(x1)
plot(sort(x1))
x1 <- rnorm(100, mean = 160, sd = 1)
x2 <- rnorm(100, mean = 170, sd = 1)
x1
x2
t.test(x1, x2)
x1 <- rnorm(1000, mean = 160, sd = 1)
x2 <- rnorm(1000, mean = 170, sd = 1)
hist(x1)
hist(x2, add=T)
hist(x1)
hist(x2, add=T)
hist(x2)
?hist
carrots <- data.frame(length = rnorm(100000, 6, 2))
cukes <- data.frame(length = rnorm(50000, 7, 2.5))
carrots
carrots$veg <- 'carrot'
cukes$veg <- 'cuke'
vegLengths <- rbind(carrots, cukes)
ggplot(vegLengths, aes(length, fill = veg)) + geom_density(alpha = 0.2)
x1$dist="dist1"
x1
x1 <- rnorm(1000, mean = 160, sd = 1)
x1 <- data.frame(rnorm(1000, mean = 160, sd = 1))
x1$dist="dist1"
x2 <- data.frame(rnorm(1000, mean = 170, sd = 1))
x2$dist="dist2"
x <- rbind(x1, x2)
x1 <- data.frame(rnorm(1000, mean = 160, sd = 1))
x2 <- data.frame(rnorm(1000, mean = 170, sd = 1))
hist(x1)
hist(x2)
x1$dist="dist1"
x2$dist="dist2"
x <- rbind(x1, x2)
x1 <- data.frame(rnorm(1000, mean = 160, sd = 1))
x2 <- data.frame(rnorm(1000, mean = 170, sd = 1))
hist(x1)
hist(x2)
x1$dist='dist1'
x2$dist='dist2'
x <- rbind(x1, x2)
hist(x1, col=rgb(0.1,0.1,0.1,0.5),xlim=c(0,10), ylim=c(0,200), main=”Overlapping Histogram”)
hist(x1)
x1 <- (rnorm(1000, mean = 160, sd = 1))
x2 <- (rnorm(1000, mean = 170, sd = 1))
hist(x1), col=rgb(0.1,0.1,0.1,0.5),xlim=c(0,10), ylim=c(0,200), main=”Overlapping Histogram”)
hist(x1, col=rgb(0.1,0.1,0.1,0.5),xlim=c(0,10), ylim=c(0,200), main=”Overlapping Histogram”)
hist(x2, col=rgb(0.8,0.8,0.8,0.5), add=T)
x1 <- (rnorm(1000, mean = 160, sd = 1))
x1 <- rnorm(1000, mean = 160, sd = 1)
x2 <- rnorm(1000, mean = 170, sd = 1)
hist(x1, col=rgb(0.1,0.1,0.1,0.5),xlim=c(0,10), ylim=c(0,200), main=”Overlapping Histogram”)
hist(x1, col=rgb(0.1,0.1,0.1,0.5),xlim=c(0,10), ylim=c(0,200))
hist(x2, col=rgb(0.8,0.8,0.8,0.5), add=T)
box()
graphics.off()
hist(x1, col=rgb(0.1,0.1,0.1,0.5),xlim=c(0,10), ylim=c(0,200))
hist(x2, col=rgb(0.8,0.8,0.8,0.5), add=T)
box()
graphics.off()
hist(x1, xlim=c(0,10), ylim=c(0,200))
hist(x2,  add=T)
box()
graphics.off()
hist(x1, xlim=c(0,10), ylim=c(0,200))
hist(x1)#, xlim=c(0,10), ylim=c(0,200))
hist(x2,  add=T)
hist(x1)#, xlim=c(0,10), ylim=c(0,200))
hist(x1,, xlim=c(110, 200), ylim=c(0,200))
hist(x1, xlim=c(140, 190), ylim=c(0,200))
hist(x2,  add=T)
t.test(x1, x2)
x1 <- rnorm(1000, mean = 160, sd = 1)
x2 <- rnorm(1000, mean = 165, sd = 1)
t.test(x1, x2)
hist(x1, xlim=c(140, 190), ylim=c(0,200))
hist(x2,  add=T)
x1 <- rnorm(1000, mean = 170, sd = 1)
x2 <- rnorm(1000, mean = 173, sd = 1)
t.test(x1, x2)
graphics.off()
hist(x1, xlim=c(140, 190), ylim=c(0,200))
hist(x2,  add=T)
hist(x1, xlim=c(160, 190), ylim=c(0,200))
hist(x1, xlim=c(160, 180), ylim=c(0,200))
hist(x2,  add=T)
box()
hist(x1, xlim=c(160, 180), ylim=c(0,200), col=rgb(0.1,0.1,0.1,0.5))
hist(x1, xlim=c(160, 180), ylim=c(0,200), col=rgb(0.1,0.1,0.1,0.5))
hist(x2,   col=rgb(0.8,0.8,0.8,0.5), add=T)
box()
hist(x1, xlim=c(160, 180), ylim=c(0,200), col=rgb(0.1,0.1,0.1,0.5))
hist(x2,   col=rgb(0.8,0.8,0.8,0.5), add=T)
hist(x1, xlim=c(160, 180), ylim=c(0,230), col=rgb(0.1,0.1,0.1,0.5))
hist(x2,   col=rgb(0.8,0.8,0.8,0.5), add=T)
hist(x1, xlim=c(160, 180), ylim=c(0,230),  col=rgb(1,0,0,0.5))
hist(x2,   col=rgb(0.8,0.8,0.8,0.5), add=T)
hist(x1, xlim=c(160, 180), ylim=c(0,230),  col=rgb(1,0,0,0.5))
hist(x2, col=rgb(0,0,1,0.5), add=T)
hist(x1, xlim=c(160, 180), ylim=c(0,230),  col=rgb(1,0,0,0.5), main="")
hist(x2, col=rgb(0,0,1,0.5), add=T)
vegLengths <- rbind(carrots, cukes)
x   <- seq(5,15,length=1000)
y   <- dnorm(x,mean=10, sd=3)
plot(x,y, type="l", lwd=1)
x   <- seq(5,15,length=1000)
y   <- dnorm(x,mean=0, sd=1)
plot(x,y, type="l", lwd=1)
x   <- seq(5,15,length=1000)
y   <- dnorm(x,mean=10, sd=3)
plot(x,y, type="l", lwd=1)
hist(y, prob=TRUE, ylim=c(0,.06), breaks=20)
curve(dnorm(x, mean(y), sd(y)), add=TRUE, col="darkblue", lwd=2)
graphics.off()
hist(y, prob=TRUE, ylim=c(0,.06), breaks=20)
curve(dnorm(x, mean(y), sd(y)), add=TRUE, col="darkblue", lwd=2)
graphics.off()
hist(y, prob=TRUE, ylim=c(0,.06), breaks=20)
graphics.off()
xseq<-seq(-4,4,.01)
y<-2*xseq + rnorm(length(xseq),0,5.5)
hist(y, prob=TRUE, ylim=c(0,.06), breaks=20)
curve(dnorm(x, mean(y), sd(y)), add=TRUE, col="darkblue", lwd=2)
xseq<-seq(-4,4,.01)
y<-2*xseq + rnorm(length(xseq),0,5.5)
y<-2*xseq + rnorm(length(xseq),160,1)
hist(y, prob=TRUE, ylim=c(0,.06), breaks=20)
curve(dnorm(x, mean(y), sd(y)), add=TRUE, col="darkblue", lwd=2)
hist(x)
graphics.off()
hist(x)
hist(x1)
hist(x1, prob=TRUE)
xseq <- seq(0, 200, .1)
y1 <- 2*xseq + rnorm(length(xseq),170, 1 )
y2 <- 2*xseq + rnorm(length(xseq),173, 1)
xseq <- seq(0, 200, .1)
y1 <- 2*xseq + rnorm(length(xseq),170, 1)
y2 <- 2*xseq + rnorm(length(xseq),173, 1)
hist(y1, prob=TRUE)
graphics.off()
xseq <- seq(0, 200, .1)
y1 <- 2*xseq + rnorm(length(xseq),170, 1)
y2 <- 2*xseq + rnorm(length(xseq),173, 1)
hist(y1, prob=TRUE)
xseq
min(xseq)
max(xseq)
y1 <- 2*xseq + rnorm(length(xseq),170, 1)
y2 <- 2*xseq + rnorm(length(xseq),173, 1)
hist(y1, prob=TRUE)
x <- rnorm(100, 150, 1)
h<-hist(x, breaks=10, col="red", xlab="Miles Per Gallon",
main="Histogram with Normal Curve")
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)
x <- rnorm(100, 150, 1)
h<-hist(x, breaks=10, col="red", xlab="height")
x <- rnorm(100, 170, 1)
h<-hist(x, breaks=10, col="red", xlab="height")
x <- rnorm(1000, 170, 1)
h<-hist(x, breaks=10, col="red", xlab="height")
x <- rnorm(5000, 170, 1)
h<-hist(x, breaks=10, col="red", xlab="height")
h<-hist(x, breaks=10, col="red", xlab="height", n=100)
x <- rnorm(5000, 170, 1)
h<-hist(x, col="red", xlab="height", n=100)
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=100)
h<-hist(x, col="red", xlab="height", n=50)
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="red", xlab="height", n=50)
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=50)
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)
x2 <- rnorm(1000, 173, 1)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="blue", xlab="height", n=50, add=T)
xfit<-seq(min(x2),max(x2),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=50)
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="blue", xlab="height", n=50, add=T)
xfit<-seq(min(x2),max(x2),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)
lines(xfit, yfit, col="black", lwd=2)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="black", lwd=2)
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=50)
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="black", lwd=2)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="blue", xlab="height", n=50, add=T)
xfit2<-seq(min(x2),max(x2),length=40)
yfit2<-dnorm(xfit2,mean=mean(x2),sd=sd(x2))
yfit2 <- yfit2*diff(h$mids[1:2])*length(x2)
lines(xfit2, yfit2, col="black", lwd=2)
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=50, main="")
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="black", lwd=2)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="blue", xlab="height", n=50, add=T, main="")
xfit2<-seq(min(x2),max(x2),length=40)
yfit2<-dnorm(xfit2,mean=mean(x2),sd=sd(x2))
yfit2 <- yfit2*diff(h$mids[1:2])*length(x2)
lines(xfit2, yfit2, col="black", lwd=2)
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=50, main="", xlim=c(160, 180))
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="black", lwd=2)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="blue", xlab="height", n=50, add=T, main="")
xfit2<-seq(min(x2),max(x2),length=40)
yfit2<-dnorm(xfit2,mean=mean(x2),sd=sd(x2))
yfit2 <- yfit2*diff(h$mids[1:2])*length(x2)
lines(xfit2, yfit2, col="black", lwd=2)
x <- rnorm(1000, 170, 1)
h<-hist(x, col="red", xlab="height", n=50, main="", xlim=c(165, 180))
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="black", lwd=2)
x2 <- rnorm(1000, 173, 1)
h<-hist(x2, col="blue", xlab="height", n=50, add=T, main="")
xfit2<-seq(min(x2),max(x2),length=40)
yfit2<-dnorm(xfit2,mean=mean(x2),sd=sd(x2))
yfit2 <- yfit2*diff(h$mids[1:2])*length(x2)
lines(xfit2, yfit2, col="black", lwd=2)
load("../Scripts/testData.RData")
rm(list=ls())
load("../Scripts/testData.RData")
rm(list=ls())
load("../Scripts/testData.RData")
dim(data.counts)
summary(data.counts)
print(dim(data.counts))
print(dim(data.counts))
hist(data.counts[,1])
dim(data.counts)
idx.0 <- apply(data.counts, 1, sum)
idx.0
length(idx.0)
hist(idx.0)
min(idx.0)
max(idx.0)
length(which(idx.0)==0)
length(which(idx.0)==0)
length(which(idx.0==0))
idx.00 <- which(idx.0==0)
data.subset <- data.counts[-idx.00,]
idx.0[1]
hist(data.subset[1,], main="", xlab="Read Counts")
data.subset <- data.counts[-idx.00,]
hist(data.subset[1,], main="", xlab="Read Counts")
length(idx.00)
class(idx.00)
class(data.counts)
data.subset <- as.matrix(data.counts[-idx.00,])
hist(data.subset[1,], main="", xlab="Read Counts")
hist(data.counts[1,], main="", xlab="Read Counts")
data.counts <- as.matrix(data.counts)
data.subset <- as.matrix(data.counts[-idx.00,])
par(mfrow=c(1,2))
hist(data.counts[1:100,], main="", xlab="Read Counts")
hist(data.subset[1:100,], main="", xlab="Read Counts")
hist(data.subset[1:1000,], main="", xlab="Read Counts")
hist(data.subset[1:100,], main="", xlab="Read Counts")
m.dummy <- matrix(data=0, nrow=row(data.subset), ncol=ncol(data.subset))
dim(m.dummy)
m.dummy <- matrix(data=0, nrow=row(data.subset), ncol=ncol(data.subset))
dim(m.dummy)
m.dummy <- matrix(data=0, nrow=nrow(data.subset), ncol=ncol(data.subset))
dim(m.dummy)
m.dummy[data.subset==0]=1
m.summary <- apply(m.dummy, 1, sum)
m.summary
hist(m.summary)
hist(data.subset[1:100,], main="", xlab="Read Counts", ylim=c(0, 6000))
hist(data.subset[1:100,], main="", xlab="Read Counts", ylim=c(0, 1000))
hist(data.subset[1:200,], main="", xlab="Read Counts", ylim=c(0, 1000))
hist(data.subset[1:200,], main="", xlab="Read Counts")
setwd("~/Documents/NBIS/Teaching/!Teaching/201710_scRNA/Lecture")
