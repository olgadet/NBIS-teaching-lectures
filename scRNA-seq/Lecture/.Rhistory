f(3)
x %>% f
# basic R
mtcars2 <- transform(mtcars, lp100k = 235.21/mpg)
subset(mtcars2, lp100k <= 10)
# pipelines magrittr
mtcars %>% transform(lp100 = 235.21/mg) %>% subset(lpk100 <= 10)
# pipelines magrittr
mtcars %>% transform(lp100 = 235.21/mpg) %>% subset(lpk100 <= 10)
# pipelines magrittr
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
# basic R
mtcars2 <- transform(mtcars, lp100k = 235.21/mpg)
subset(mtcars2, lp100k <= 10)
# pipelines magrittr
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
class(mtcars)
max(sin(rnorm(1000)))
# Task 1
rnorm(1000) %>% sin() %>% max()
max(sin(rnorm(1000)))
# Task 2
library(MASS)
subset(transform(mammals, ratio=brain/body), ratio==max(ratio))
# Task 2
library(MASS)
head(mammals)
subset(transform(mammals, ratio=brain/body), ratio==max(ratio))
mammals %>% transform(ratio=brain/body) %>% subset(ratio==max(ratio))
231+25+102+55+171
584/140
# pipelines opearators (>, $, <>)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
# pipelines opearators (>, $, <>)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10) %$% cor(disp, hp)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10) %>% cor(disp, hp)
# pipelines opearators (>, $, <>)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10) %>% max(disp)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10) %$% max(disp)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10) %$% cor(disp, hp)
mtcars %<>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
mtcars
# pipelines opearators (>, $, <>)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
mtcars
rm(list=ls())
mtcars
# pipelines opearators (>, $, <>)
mtcars %>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
mtcars
mtcars %<>% transform(lp100k = 235.21/mpg) %>% subset(lp100k <= 10)
library(dplyr)
class(starwars)
starwards
starwars
str(starwars)
starwars
starwars[, c("name", "starships")]
starwars[10, "starships"]
starwars[10, ]
starwars[10, "starships"]
starwars[10, "starships"][[1]]
starwars[10, "starships"][1]
starwars[10, "starships"]
starwars[10, "starships"][[1]]
library(tidyverse)
RVersion()
?version
R.Version()
library(tidyverse)
library(tidyverse)
starwars[, c("name", "starships")]
library(tidyverse)
kids <- matrix(4, 11, 15, 28, 101, 132, f, m)
kids <- data.frame(age=c(4,11), weight=c(15, 28), height=c(101, 132), gender=c("f", "m"))
kids
rownames(kids) <- c("Sarah", "John")
kids.tibble <- as_tibble(kids)
kids.tibble
kids.tibble$name <- rownames(kids)
kids.tibble
kids.tibble <- kids.tibble[, c("name", "age", "weight", "height", "gender")]
kids.tibble
# or
kids.tibble <- as_tibble(kids)
kids.tibble
kids.tibble <- rownames_to_column(kids)
kids.tibble
rownames_to_column(kids)
kidsdf <- as.data.frame(kids.tibble)
kidsdf
class(kidsdf)
# tibble and tribble
kids.tibble <- tibble(names=c("Sarah", "John"), age=c(4,11), weight=c(15, 28), height=c(101, 132), gender=c("f", "m"))
kids.tibble
kids.tribble <- tibble(~name, ~age, ~weight, ~heigth, ~gender,
"Sarah", 4, 15, 101, f,
"John", 11, 28, 132, m)
kids.tribble <- tibble(~name, ~age, ~weight, ~heigth, ~gender,
"Sarah", 4, 15, 101, f,
"John", 11, 28, 132, m)
kids.tribble <- tibble(~name, ~age, ~weight, ~heigth, ~gender,
"Sarah", 4, 15, 101, "f",
"John", 11, 28, 132, "m")
kids.tribble <- tribble(~name, ~age, ~weight, ~heigth, ~gender,
"Sarah", 4, 15, 101, "f",
"John", 11, 28, 132, "m")
kids.tribble
knitr::opts_chunk$set(echo = TRUE)
pr.success <- 1-2.5/100
pr.cu
pr.success
pr.pass <- pr.success
# Example 2
# testing
pr.success <- 1-2.5/100
pr.pass <- pr.success
for (2 in 1:20)
# Example 2
# testing
pr.success <- 1-2.5/100
pr.pass <- pr.success
for (i in 2:20)
{
pr.pass <- pr.pass * pr.success
}
# Example 2
# testing
pr.success <- 1-2.5/100
pr.pass <- pr.success
for (i in 2:20)
{
pr.pass <- pr.pass * pr.success
}
pr.pass
pr.success
pr.success*pr.success
# Example 2
# testing
pr.success <- 1-2.5/100
pr.pass <- pr.success
for (i in 2:20)
{
pr.pass <- pr.pass * pr.success
}
pr.pass
pr.fail <- 1- pr.pass
pr.fail
1-(3/4)^20
(1-(3/4))^20
?dbinom
?pbinom
80 - 25
55 - 8
0.04/0.40
0.30/0.40
0.06/0.40
0.01/0.35
0.07/0.35
0.27/0.35
15*15
60*225
225/60
450 / 60
40*4
40*4*2
40*4*2
2*8*3
40*4*2 + 2*8*3
40*4*2 + 2*8*3
40*4*2 + 2*8*3
40*4*2 + 2*8*3 + 3 * 8 * 1.5
40*4*2 + 2*8*3 + 3 * 8 * 1.5
40*4*2 + 2*8*3 + 3 * 8 * 1.5
8*2/(2^2*2^3)
8*2*3/(2^4*2)
8*2*3/(2^6)
8*2*3*4/(2^6)
8*2*3*4/(2^6) +  8*2*3/(2^6)
3*5
3*5*sqrt(15)
sqrt(15)
(3/4)/sqrt(15)
12/30
8*2*3/(2*2^4)
8*2/(2^2*2^3)
8*2*3/(2^4*2)
8*2*3/(2^2*2^4)
8*2*3*4/(2*2^5)
15/4
15/4-(3/2*2)
8*2*3*4/(2*2^5)
3/2
3/4
(3/4)/sqrt(3*5)
19/30
3-(3/2)^2
(3/4)/sqrt(3/4)
sqrt(3/4)
1900 * 0.20
9*25
sqrt(9*25)
-9/15
-9/sqrt(9*25)
1-(9/22)*(-0.6+5)
1-(9/25)*(-0.6+5)
9 - 81/25
9 - (-9/25)*(-9)
1-(9/25)*(-0.6+5)
(0.125)^(1/3)
(0.008)^(1/3)
(0.027)^(1/3)
3*3/10*(1-3/10)
3*2/10*(1-2/10)
sqrt(63*48/10000)
(-18/100)/sqrt(63*48/10000)
-3*3/10*2/10
(-18/100)/sqrt(63*48/100*100)
(-18/100)/sqrt(63*48/(100*100))
3/10
20/30
n <- 10     # number of tracks
theta <- (1:n-1)/10
theta
1-theta
z <- matrix(0, N, n)
# Example 1
N <- 10000  # number of simulations
n <- 10     # number of tracks
theta <- (1:n-1)/10
z <- matrix(0, N, n)
dim(z)
head(z)
# Example 1
N <- 10000  # number of simulations
n <- 10     # number of tracks
theta <- (1:n-1)/10
z <- matrix(0, N, n)
for (i in 1:n){
z[, i] <- rgeom(N, 1-theta[i]) + 1
}
head(z)
S <- rowSums(z)
head(S)
length(S)
mean(S)
hist(S)
head(S)
N
i=1
test <- rgeom(N, 1-theta[i]) + 1
length(test)
head(test)
test
sum(test)
quantile(test)
i
i=2
test <- rgeom(N, 1-theta[i]) + 1
test
1600*0.1
1-0.1
1600*0.1*(1-0.1)
160*0.9
1600*0.9
39.5-50
(39.5-50)/sqrt(25)
1-0.9821
(39.5-50)/sqrt(25)
(40.5-50)/sqrt(25)
pnorm(1.9)
pnorm(-1.9)
(60.5-50)/sqrt(25)
1-pnorm(2.1)
(59.5-50)/sqrt(25)
1-pnorm(1.9)
60*0.9
54*0.1
(49.5-54)/sqrt(5.4)
(59.5-54)/sqrt(5.4)
137-0.5
(136.5 - 160)/(sqrt(144))
(136.5 - 160)/sqrt(144)
sqrt(144)
(59.5 - 50)/sqrt(25)
1-pnorm(1.9)
(59.5 - 50)/sqrt(25)
(136.5 - 160)/sqrt(144)
pnorm((136.5 - 160)/sqrt(144))
1-pnorm((136.5 - 160)/sqrt(144))
1-pnorm(137-0.5, mean=1600*0.1, sd=1600*0.1(1-0.1))
1-pnorm(137-0.5, mean=1600*0.1, sd=1600*0.1*(1-0.1))
u <- 1600*0.1
u
s <- 1600*0.1*(1-0.1)
s
pnorm(137-0.5)
pnorm(137-0.5, mean=u, sd=s)
pnorm(137-0.5, mean=u, sd=sqrt(s))
1-pnorm(137-0.5, mean=u, sd=sqrt(s))
24/30
27/30
14+25+11
100+0.5-50
(100+0.5-50)/sqrt(50)
sqrt(50)
50/sqrt(50)
pnorm(7)
pnorm((100+0.5-50)/sqrt(50))
5*14
5*14+25+11
(100+0.5-106)/sqrt(50))
(100+0.5-106)/sqrt(50)
pnorm((100+0.5-106)/sqrt(50)))
pnorm((100+0.5-106)/sqrt(50))
1-pnorm((100+0.5-106)/sqrt(50))
(100+0.5-106)/sqrt(50)
x <- (100+0.5-106)/sqrt(50)
1-pnorm(abs(x))
1-0.7794
5*14
70 + 25 + 11
100.5-106
(100.5-106)/sqrt(106)
(100.5-106)/sqrt(106)
(100.5-106)/sqrt(106)
a <- (100.5-106)/sqrt(106)
a
1-pnorm(abs(a))
100.5-1006
100.5-106
(100.5-106)/sqrt(106)
a
pnorm(abs(a))
a
a
1-pnorm(abs(a))
24+2.25
(24+2.25)/30
1-0.1
*10
0.9*10
0.5/3
1-pnorm(0.5/3)
1-0.1
1-0.1*0.1
(1-0.1)*0.1
0.9/0.3
3/0.3
3*0.3
a <- 1.645^2/3^2
b <- a
a <- 1
c <- (89.5/0.3)^2
a
b
c
delta <- b^2-4*a*c
delta
b <- -1*1.645^2/3^2
delta
delta <- b^2-4*a*c
delta
a
c
c <- -1*(89.5/0.3)^2
delta <- b^2-4*a*c
delta
x1 <- (-b+sqrt(delta))/(2*a)
x1
ba <- 1
a <- 1
# Example 1
N <- 10000  # number of simulations
n <- 10     # number of tracks
theta <- (1:n-1)/10
z <- matrix(0, N, n)
for (i in 1:n){
z[, i] <- rgeom(N, 1-theta[i]) + 1
}
S <- rowSums(z)
mean(S)
hist(S)
b <- -1*(1.645^2)/(9)
a <- 1
b <- -1*(1.645^2)/(9)
a
b
c <- -1*89.5/0.9
c
delta <- b^2-4*a*c
delta
a <- 1
b <- -1*(1.645^2)/(9)
c <- -1*89.5/0.9
delta <- b^2-4*a*c
a
b
c
delta
x1 <- (-b+sqrt(delta))/(2*a)
x1
x1^2
a
b
c
a <- 1
b <- -1*(1.645^2)/(9)
c <- -1*(89.5/0.9)^2
delta <- b^2-4*a*c
x1 <- (-b+sqrt(delta))/(2*a)
a
b
c
delta
x1
x1^2
a <- 1
b <- -1*(1.645^2)/(9)
c <- -1*(89.5/0.9)^2
delta <- b^2-4*a*c
x1 <- (-b+sqrt(delta))/(2*a)
a
b
c
d
a <- 1
b <- -1*(1.645^2)/(9)
c <- -1*(89.5/0.9)^2
delta <- b^2-4*a*c
x1 <- (-b+sqrt(delta))/(2*a)
a
b
c
delta
x1
x1^2
a <- 1
b <- -1*(1.645)/(3)
c <- -1*89.5/0.9
delta <- b^2-4*a*c
x1 <- (-b+sqrt(delta))/(2*a)
a
b
c
delta
x1
x1^2
6*18.9
100 - 113.4
pnorm(0.95)
1/pnorm(0.95)
4^(-1)
1/4
pnorm(0.95)
1/(pnorm(0.95))
pnorm(1/095)
pnorm(1/0.95)
pnorm(0.95)
pnorm(0.95)^(-1)
1-1/pnor(0.95)
1-1/pnorm(0.95)
pnorm(0.95)
pnorm(0.95)
1/0.8289
1/1.645
1/1.645
1/pnorm(0.95)
pnorm(0.99)
1/pnorm(0.99)
100-113.4
100-6*18.9
1/pnorm(0.99)
(1-pnorm(0.99))
(1-pnorm(0.99))
(1/pnorm(0.99))
13.4/(1/pnorm(0.99)*sqrt(6))
13.4/((1/pnorm(0.99)*sqrt(6))
)
13.4/(1/pnorm(0.99)*sqrt(6))
?pnorm
1/pnorm(0.95, lower.tail=FALSE)
pnorm(0.1)
a <- pnorm(0.1)
1/a
qnorm(0.1)
a
pnorm(0.1)
a
qnorm(a)
qnorm(0.95)
13.4/(qnorm(0.99)*sqrt(6))
13.4/(qnorm(0.99)*sqrt(6))
qnorm(0.99)
qnorm(0.99)*sqrt(6)
13.4(qnorm(0.99)*sqrt(6))
13.4/(qnorm(0.99)*sqrt(6))
k.14 <- 149
k.16 <- 179
k.18 <- 229
k.25 <- 400
4*k.14
4*k.14 + 3*k.16
4*k.14 + 3*k.16 + 5*k.18
?prop.test
log(1/2)
log(1/20)
library(scran)
?findMarkers
setwd("~/Desktop/NBIS-teaching-lectures/scRNA-seq/Lecture")
